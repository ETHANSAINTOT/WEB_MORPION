<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>En Ligne</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <a href="javascript:history.back()">← Retour</a>
        <a href="index.html">Menu</a>
    </nav>

    <div class="container">
        <div style="border-bottom: 1px solid #444; padding-bottom: 30px; margin-bottom: 30px;">
            <h2>Créer une partie</h2>
            <button onclick="createGame()" class="btn-menu">CRÉER (Je suis X)</button>
        </div>

        <div class="center-column">
            <h2>Rejoindre</h2>
            <input type="text" id="gameId" placeholder="Entrer l'ID ici">
            <button onclick="joinGame()" class="btn-menu" style="width: auto; padding: 10px 40px;">REJOINDRE</button>
        </div>
    </div>

    <script>
        const API_URL = 'api.php'; 

        async function createGame() {
            const res = await fetch(`${API_URL}?action=create&start=X`);
            const data = await res.json();
            window.location.href = `game.html?mode=online&role=creator&id=${data.id}`;
        }

        async function joinGame() {
            const id = document.getElementById('gameId').value;
            if(!id) return alert("Il faut un ID !");
            
            const res = await fetch(`${API_URL}?action=join&id=${id}`);
            const data = await res.json();
            
            if(data.status === 'joined') {
                window.location.href = `game.html?mode=online&role=joiner&id=${id}`;
            } else {
                alert("Impossible de rejoindre (ID invalide ou partie pleine)");
            }
        }
    </script>
</body>
</html>
